<style type="text/css">@import "/stylesheets/jquery.datepick.css";</style> 
<style type="text/css">@import "/stylesheets/jquery.icalendar.css";</style> 

<script src="/javascripts/jquery.dimensions.pack.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tooltip.pack.js" type="text/javascript"></script>
<script type="text/javascript" src="/javascripts/jquery.tablehover.min.js"></script>
<script type="text/javascript" src="/javascripts/jquery.icalendar.min.js"></script>
<script type="text/javascript" src="/javascripts/jquery.datepick.min.js"></script>                 
<script type="text/javascript">
$(document).ready(function() 
{ 
$('#child *').tooltip();
$("#timetable").tableHover({});
$('#child *').click(function(event){
	
/*alert("Feature coming soon...");*/
})
}); 	
</script>
<script type="text/javascript">
 
    //$(document).ready(function(){   
    //    $("#button").click(function(){
    //        $("#pane").style.display = 'show';
    //        alert("E");
    //    });        
    //});
        
    function setDateFromDialog(date){
        var starthour = $('#starthour').val()
        var duration = $('#duration').val()
        
        mystarthour = (starthour) ? time : 12;
        myduration = (duration) ? duration : 90;
        
        var StartDate = new Date(date)
        var EndDate = StartDate
        
        StartDate.setHours(mystarthour)
        EndDate.setHours(StartDate.getHours() + myduration / 60)
        EndDate.setMinutes(StartDate.getMinutes() + myduration % 60)
        //console.log(EndDate)        
        
        var TimeDJEvent = {
            start: StartDate,
            end: EndDate,
            title: 'Your Meeting',
            description: 'This Meeting was planned using The TimeDJ. Checkout timedj.com for more details',
            location: 'On your local beach'
        };
        
        $('#basicICal').icalendar($.extend({
            icons: '/images/icalendar.png',
			compact: true,
            sites: ['yahoo', 'google'] //, 'outlook'],
            //echoUrl: "/iCalEcho.rb"
        }, TimeDJEvent))
        $('#basicICal').icalendar('change', TimeDJEvent);
    }
    
    $(function(){
        $('#dialogButton123').datepick({
            onClose: setDateFromDialog
        })
    });
</script>

<div class="ColContainer">

<div class="LtCol">
</div>	

<div class="RtCol"> 
       <div class="pane" style="">
           Meeting date: <input class="Body" type="input" size=5 id="dialogButton123" value="">
           </input>
           <div id="basicICal">
           </div>
       </div>
</div>

<div class="CtrCol" id="CtrCol" style="margin-top:10px;">
	
    <div class="Muffin">
        <table id="timetable" align="center">
	    <thead>		
	    <tr>
		<%@myinputs.each do |i| %>
	        	<%= "<th> #{i.utf8_name},<BR>"%>
	        	<%= "#{i.country.name}<BR>" %>
	        	<%= "(#{i.time_zone.name})</th>" %> 
		<%end%>     
	    </tr>
	    </thead>
	    <tbody>

		<%(0 .. 23).each do |i| %>
			<%  if i== 0 then
				@tr_id = "Early_Morning"
				 elsif (i== 18) 
				@tr_id = "Late_Evening"
	 			elsif (i== 8) 
				@tr_id = "Work_Day"
				else
				@tr_id=""
				end %>
			
			<%= if (@tr_id !="") 
				line = "<th colspan=100% class=parent id=#{@tr_id} "
				line += "style='font-weight: bold' " if (@tr_id == "Work_Day") 
				line += "> #{@tr_id=~ %r{(.*)_(.*)}; $1+" "+$2} </th>"
				line 
			end%>
			<% am_pm = i < 12 ? "am" : "pm" %>
			<%= if i==23 then "<tfoot>" end%>			
			<%= "<tr id=child title=\"Coming Soon --> Click to Add to Calendar\" >" %>
			
			<%= "<td class=\"#{(i <8|| i>17) ? "dim_time" : ((i < @min_good_hour || i > @max_good_hour) ? "dim_awake_time" : "awake_time")}\"> #{(i%12 != 0) ? i%12 : 12}:00 #{am_pm}</td>"%>
			
			<%(1..(@myinputs.length-1)).each do |j|%>
				<% tz_delta = i + @tzdeltas[j]%>
				<% am_pm = tz_delta%24 < 12 ? "am" : "pm" %>
				<%= "<td class=\"#{(tz_delta <8 || (tz_delta>17 && tz_delta <32)) ? "dim_time" : ((i < @min_good_hour || i > @max_good_hour) ? "dim_awake_time" : "awake_time")}\">#{(tz_delta%12 != 0) ? tz_delta%12 : 12}:00 #{am_pm}</td>"%>
			<%end%>
			<%= "</tr>" %>
			<%= if i==23 then "</tfoot>" end%>
		<%end%>
		
	   </tbody>
       </table>
       </div>	   
       <!-- closing Muffin-->
	   
</div>

</div>